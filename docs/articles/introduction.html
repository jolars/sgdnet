<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An Introduction to sgdnet • sgdnet</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to sgdnet">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sgdnet</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/algorithm.html">Technical Documentation</a>
    </li>
    <li>
      <a href="../articles/benchmarks.html">Benchmarks</a>
    </li>
    <li>
      <a href="../articles/cross-validation.html">Cross-Validation in sgdnet</a>
    </li>
    <li>
      <a href="../articles/introduction.html">An Introduction to sgdnet</a>
    </li>
    <li>
      <a href="../articles/models.html">Model Families in sgdnet</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jolars/sgdnet">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>An Introduction to sgdnet</h1>
                        <h4 class="author">Johan Larsson</h4>
            
            <h4 class="date">2018-08-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jolars/sgdnet/blob/master/vignettes/introduction.Rmd"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<div id="background-and-motivation" class="section level2">
<h2 class="hasAnchor">
<a href="#background-and-motivation" class="anchor"></a>Background and motivation</h2>
<p>The goal of <strong>sgdnet</strong> is to be a one-stop solution for fitting elastic net-penalized generalized linear models in the <span class="math inline">\(n \gg p\)</span> regime. This is of course not novel in and by itself. Several packages, such as the popular <em>glmnet</em> package <span class="citation">(Friedman, Hastie, and Tibshirani 2010)</span>, already exists to serve this pupose. With <em>sgdnet</em>, however, we set out to improve upon the existing solutions in a number of ways:</p>
<ul>
<li>fit generalized linear models using the efficient SAGA algorithm <span class="citation">(Defazio, Bach, and Lacoste-Julien 2014)</span>, which promises to outperform the coordinate descent method that is commonly used to fit the elastic net,</li>
<li>craft a well-documented and accessible codebase to promote collaboration and review, and</li>
<li>implement a general framework in which additional model families, proximal operators, and other algorithms could be incorporated.</li>
</ul>
<p><strong>sgdnet</strong> has on purpose been created to mimic the interface of <strong>glmnet</strong>. Transitioning between the two is a breeze.</p>
<p>In this vignette, we will look at the basics of fitting a model and reviewing the results of it.</p>
</div>
<div id="fitting-a-model" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-a-model" class="anchor"></a>Fitting a model</h2>
<p>We will look at Edgar Anderson’s well-known iris data set, giving the measurements of petal and sepal length and width of three species of iris flowers. Our objective will be to predict the species of the flower. First, we’ll split the set into a training set.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">train_ind &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">nrow</span>(iris), <span class="kw">floor</span>(<span class="fl">0.8</span><span class="op">*</span><span class="kw">nrow</span>(iris))) <span class="co"># an 80/20 split</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">iris_train &lt;-<span class="st"> </span>iris[train_ind, ]</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">iris_test &lt;-<span class="st"> </span>iris[<span class="op">-</span>train_ind, ]</a></code></pre></div>
<p>We fit the model by specifying our feature matrix to argument <code>x</code> and our response to <code>y</code>, using <code>family = "multinomial"</code> to specify the type of model we would like to fit.</p>
<p>The elastic net mixing parameter in <strong>sgdnet</strong> is specified via the <code>alpha</code> argument, where a value of 1 imposes the lasso (<span class="math inline">\(\ell_1\)</span>) penalty, and 0 the ridge (<span class="math inline">\(\ell_2\)</span>) penalty. For this example, we’ll stick with the default (<code>alpha = 1</code>, the lasso).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(sgdnet)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">fit &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sgdnet.html">sgdnet</a></span>(iris_train[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>],       <span class="co"># predictor matrix</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">              iris_train<span class="op">$</span>Species,      <span class="co"># response</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">              <span class="dt">family =</span> <span class="st">"multinomial"</span>,  <span class="co"># model family</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">              <span class="dt">alpha =</span> <span class="dv">1</span>)               <span class="co"># elastic net mixing parameter (default)</span></a></code></pre></div>
<p>The regularization strength is specified via the <code>lambda</code> argument. A high value will impose a larger penalty. We did not specify it here, nor do we need to as <strong>sgdnet</strong> takes care of fitting our model along a regularization path of different <span class="math inline">\(\lambda\)</span> values, starting at the value at which the solution is expected to be completely sparse, that is, the point at which all coefficients (save for the intercept if it is included) are zero.</p>
</div>
<div id="plotting-the-fit" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-the-fit" class="anchor"></a>Plotting the fit</h2>
<p>The result can be printed, which will show a summary of the deviance ratio of the model along the regularization path. Usually, however, it is more effective to study the fit by visualizing it.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">plot</span>(fit)</a></code></pre></div>
<div class="figure">
<img src="introduction_files/figure-html/unnamed-chunk-3-1.png" alt="Multinomial logistic regression with **sgdnet** on the iris data set." width="672"><p class="caption">
Multinomial logistic regression with <strong>sgdnet</strong> on the iris data set.
</p>
</div>
<p>What we see here are the linear predictors for the multinomial model with the <span class="math inline">\(\ell_1\)</span>-norm along the x-axis. These are always returned on the original scale of the variables even if the argument <code>standardize = TRUE</code> is provided to <code><a href="../reference/sgdnet.html">sgdnet()</a></code>, which happens to be the default.</p>
</div>
<div id="assessing-the-fit" class="section level2">
<h2 class="hasAnchor">
<a href="#assessing-the-fit" class="anchor"></a>Assessing the fit</h2>
<p>Now that we have fit our model, we would like to see how well it fits. This is why we left out a testing subset of the data at the start. <strong>sgdnet</strong> contains a method for <code>predict()</code>, which takes a new set of data and computes predictions for the response based on this.</p>
<p>To predict the class (response) – in this case the species of iris – of the observation, we’ll use the “class” argument.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">pred_class &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, iris_test[, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">type =</span> <span class="st">"class"</span>)</a></code></pre></div>
<p>This gives us the class predictions along the entire regularization path. If we had wanted to predict at a specific <span class="math inline">\(\lambda\)</span>, we could have specified it using the <code>s</code> argument in our call to <code>predict()</code>.</p>
<p>We’ll now consider the accuracy along the entire path.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">acc &lt;-<span class="st"> </span><span class="kw">apply</span>(pred_class, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="kw">sum</span>(iris_test<span class="op">$</span>Species <span class="op">==</span><span class="st"> </span>x)<span class="op">/</span><span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">library</span>(lattice)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw"><a href="http://www.rdocumentation.org/packages/lattice/topics/xyplot">xyplot</a></span>(acc <span class="op">~</span><span class="st"> </span>fit<span class="op">$</span>lambda, <span class="dt">type =</span> <span class="st">"l"</span>,</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">       <span class="dt">xlab =</span> <span class="kw">expression</span>(lambda),</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">       <span class="dt">ylab =</span> <span class="st">"Accuracy"</span>,</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">       <span class="dt">grid =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="figure">
<img src="introduction_files/figure-html/unnamed-chunk-5-1.png" alt="Accuracy in predictions from our model fit to the iris data set." width="700"><p class="caption">
Accuracy in predictions from our model fit to the iris data set.
</p>
</div>
<p>Of course, the choice of <span class="math inline">\(\lambda\)</span> cannot be based only on our training data. In any real application we would do best to rely on cross-validation to pick a suitable value.</p>
</div>
<div id="acknowledgements" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h2>
<p>Development on <strong>sgdnet</strong> begun as a Google Summer of Code project in 2018 with the <em>R Project for Statistical Computing</em> as mentor organization. Michael Weylandt and Toby Dylan Hocking mentored the project.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-defazio2014">
<p>Defazio, Aaron, Francis Bach, and Simon Lacoste-Julien. 2014. “SAGA: A Fast Incremental Gradient Method with Support for Non-Strongly Convex Composite Objectives.” In <em>Advances in Neural Information Processing Systems 27</em>, 2:1646–54. Montreal, Canada: Curran Associates, Inc.</p>
</div>
<div id="ref-friedman2010">
<p>Friedman, Jerome, Trevor Hastie, and Robert Tibshirani. 2010. “Regularization Paths for Generalized Linear Models via Coordinate Descent.” <em>Journal of Statistical Software</em> 33 (1): 1–22. <a href="https://doi.org/10.18637/jss.v033.i01" class="uri">https://doi.org/10.18637/jss.v033.i01</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#background-and-motivation">Background and motivation</a></li>
      <li><a href="#fitting-a-model">Fitting a model</a></li>
      <li><a href="#plotting-the-fit">Plotting the fit</a></li>
      <li><a href="#assessing-the-fit">Assessing the fit</a></li>
      <li><a href="#acknowledgements">Acknowledgements</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Johan Larsson, Toby Dylan Hocking, Michael Weylandt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
