<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit a Generalized Linear Model with Elastic Net Regularization — sgdnet • sgdnet</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Fit a Generalized Linear Model with Elastic Net Regularization — sgdnet" />

<meta property="og:description" content="Fit a Generalized Linear Model with Elastic Net Regularization" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sgdnet</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/algorithm.html">Technical Documentation</a>
    </li>
    <li>
      <a href="../articles/benchmarks.html">Benchmarks</a>
    </li>
    <li>
      <a href="../articles/cross-validation.html">Cross-Validation in sgdnet</a>
    </li>
    <li>
      <a href="../articles/introduction.html">An Introduction to sgdnet</a>
    </li>
    <li>
      <a href="../articles/models.html">Model Families in sgdnet</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jolars/sgdnet">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a Generalized Linear Model with Elastic Net Regularization</h1>
    <small class="dont-index">Source: <a href='https://github.com/jolars/sgdnet/blob/master/R/sgdnet.R'><code>R/sgdnet.R</code></a></small>
    <div class="hidden name"><code>sgdnet.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Fit a Generalized Linear Model with Elastic Net Regularization</p>
    
    </div>

    <pre class="usage"><span class='fu'>sgdnet</span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>sgdnet</span>(<span class='no'>x</span>, <span class='no'>y</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"gaussian"</span>, <span class='st'>"binomial"</span>,
  <span class='st'>"multinomial"</span>, <span class='st'>"mgaussian"</span>), <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>nlambda</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>lambda.min.ratio</span> <span class='kw'>=</span> <span class='kw'>if</span> (<span class='fu'>NROW</span>(<span class='no'>x</span>) <span class='kw'>&lt;</span> <span class='fu'>NCOL</span>(<span class='no'>x</span>)) <span class='fl'>0.01</span> <span class='kw'>else</span> <span class='fl'>1e-04</span>,
  <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>maxit</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>standardize</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>thresh</span> <span class='kw'>=</span> <span class='fl'>0.001</span>, <span class='kw'>standardize.response</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>input matrix</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>ignored</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>response variable</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>reponse type, one of <code>'gaussian'</code>, <code>'binomial'</code>,
<code>'multinomial'</code>, or <code>'mgaussian'</code>. See <strong>Supported families</strong> for details.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>elastic net mixing parameter</p></td>
    </tr>
    <tr>
      <th>nlambda</th>
      <td><p>number of penalties in the regualrization path</p></td>
    </tr>
    <tr>
      <th>lambda.min.ratio</th>
      <td><p>the ratio between <code>lambda_max</code> (the smallest
penalty at which the solution is completely sparse) and the smallest
lambda value on the path. See <strong>Regularization Path</strong> for details.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>regularization strength</p></td>
    </tr>
    <tr>
      <th>maxit</th>
      <td><p>maximum number of effective passes (epochs)</p></td>
    </tr>
    <tr>
      <th>standardize</th>
      <td><p>whether to standardize <code>x</code> or not</p></td>
    </tr>
    <tr>
      <th>intercept</th>
      <td><p>whether to fit an intercept or not</p></td>
    </tr>
    <tr>
      <th>thresh</th>
      <td><p>tolerance level for termination of the algorithm. The
algorithm terminates when
$$
    \frac{|\beta^{(t)}
    - \beta^{(t-1)}|{\infty}}{|\beta^{(t)}|{\infty}} &lt; \mathrm{thresh}
  $$</p></td>
    </tr>
    <tr>
      <th>standardize.response</th>
      <td><p>whether <code>y</code> should be standardized for
<code>family = "mgaussian"</code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>'sgdnet'</code> with the following items:</p>
<dt><code>a0</code></dt><dd><p>the intercept</p></dd>
<dt><code>beta</code></dt><dd><p>the coefficients stored in sparse matrix format
"dgCMatrix". For the multivariate families, this is a
list with one matrix of coefficients for each response or
class.</p></dd>
<dt><code>nulldev</code></dt><dd><p>the deviance of the null (intercept-only model)</p></dd>
<dt><code>dev.ratio</code></dt><dd><p>the fraction of deviance explained, where the deviance
is two times the difference in loglikelihood between the
saturated model and the null model</p></dd>
<dt><code>df</code></dt><dd><p>the number of nozero coefficients along the
regularization path. For <code>family = "multinomial"</code>,
this is the number of variables with
a nonzero coefficient for any class.</p></dd>
<dt><code>dfmat</code></dt><dd><p>a matrix of the number of nonzero coefficients for
any class (only available for multivariate models)</p></dd>
<dt><code>alpha</code></dt><dd><p>elastic net mixing parameter. See the description
of the arguments.</p></dd>
<dt><code>lambda</code></dt><dd><p>the sequence of lambda values scaled to the
original scale of the input data.</p></dd>
<dt><code>nobs</code></dt><dd><p>number of observations</p></dd>
<dt><code>npasses</code></dt><dd><p>accumulated number of outer iterations (epochs)
for the entire regularization path</p></dd>
<dt><code>offset</code></dt><dd><p>a logical indicating whether an offset was used</p></dd>
<dt><code>grouped</code></dt><dd><p>a logical indicating if a group lasso penalty was used</p></dd>
<dt><code>call</code></dt><dd><p>the call that generated this fit</p></dd>

    
    <h2 class="hasAnchor" id="model-families"><a class="anchor" href="#model-families"></a>Model families</h2>

    
    <p>Three model families are currently supported: gaussian univariate
regression, binomial logistic regression, and multinomial logistic
regression. The choice of which is made
using the <code>family</code> argument. Next follows the objectives of the various
model families:</p>
<p><em>Gaussian univariate regression</em>:</p>
<p>$$
  \frac{1}{2n} \sum_{i=1}^n (y_i - \beta_0 - x_i^\mathsf{T} \beta)^2
  + \lambda \left( \frac{1 - \alpha}{2} ||\beta||_2^2
                   + \alpha||\beta||_1 \right).
$$</p>
<p><em>Binomial logistic regression</em>:</p>
<p>$$
  -\frac1n \sum_{i=1}^n \bigg[y_i (\beta_0 + \beta^\mathsf{T} x_i) -
    \log\Big(1 + e^{\beta_0 + \beta^\mathsf{T} x_i}\Big)\bigg]
  + \lambda \left( \frac{1 - \alpha}{2} ||\beta||_2^2
                   + \alpha||\beta||_1 \right),
$$
where \(y_i \in \{0, 1\}\).</p>
<p><em>Multinomial logistic regression</em>:
$$
 -\bigg\{\frac1n \sum_{i=1}^n \Big[\sum_{k=1}^m y_{i_k} (\beta_{0_k} + x_i^\mathsf{T} \beta_k) -
 \log \sum_{k=1}^m e^{\beta_{0_k}+x_i^\mathsf{T} \beta_k}\Big]\bigg\}
 + \lambda \left( \frac{1 - \alpha}{2}||\beta||_F^2 + \alpha \sum_{j=1}^p ||\beta_j||_q \right),
$$
where \(q \in {1, 2}\) invokes the standard lasso and 2 the
group lasso penalty respectively, \(F\) indicates the Frobenius norm,
and \(p\) is the number of classes.</p>
<p><em>Multivariate gaussian regression</em>:
$$
  \frac{1}{2n} ||\mathbf{Y} -\mathbf{B}_0\mathbf{1} - \mathbf{B} \mathbf{X}||^2_F
  + \lambda \left((1 - \alpha)/2||\mathbf{B}||_F^2 + \alpha ||\mathbf{B}||_{12}\right),
$$
where \(\mathbf{1}\) is a vector of all zeros, \(\mathbf{B}\) is a
matrix of coefficients, and \(||\dot||_{12}\) is the mixed
\(\ell_{1/2}\) norm. Note, also, that Y is a matrix
of responses in this form.</p>
    
    <h2 class="hasAnchor" id="regularization-path"><a class="anchor" href="#regularization-path"></a>Regularization Path</h2>

    
    <p>The default regularization path is a sequence of <code>nlambda</code>
log-spaced elements
from \(\lambda_{\mathrm{max}}\) to
\(\lambda_{\mathrm{max}} \times \mathtt{lambda.min.ratio}\),
For the gaussian family, for instance,
\(\lambda_{\mathrm{max}}\) is
the largest absolute inner product of the feature vectors and the response
vector,
$$\max_i \frac{1}{n}|\langle\mathbf{x}_i, y\rangle|.$$</p>
    
    <h2 class="hasAnchor" id="relationship-with-glmnet"><a class="anchor" href="#relationship-with-glmnet"></a>Relationship with glmnet</h2>

    
    <p><strong>sgdnet</strong> is modeled to resemble <a href='http://www.rdocumentation.org/packages/glmnet/topics/glmnet-package'>glmnet</a> closely so that users
can expect to receive more or less equivalent output regardless of whether
<code>sgdnet()</code> or <code><a href='http://www.rdocumentation.org/packages/glmnet/topics/glmnet'>glmnet::glmnet()</a></code> is called. Nevertheless, there are a
few instances where we have decided to diverge from the behavior of
<a href='http://www.rdocumentation.org/packages/glmnet/topics/glmnet-package'>glmnet</a>:</p><ul>
<li><p>When the ridge penalty is used (<code>alpha = 0</code>), and a regularization
path (\(\lambda~s\)) is automatically generated,
<code><a href='http://www.rdocumentation.org/packages/glmnet/topics/glmnet'>glmnet::glmnet()</a></code> fits the null model as the start of the path
(as if \(\lambda = \infty\))
even though the first \(\lambda\) reported actually
doesn't yield this fit. In <a href='sgdnet-package.html'>sgdnet</a>, we have opted
to fit the model so that it is true to the path that is returned.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='predict.sgdnet.html'>predict.sgdnet()</a></code>, <code><a href='plot.sgdnet.html'>plot.sgdnet()</a></code>, <code><a href='coef.sgdnet.html'>coef.sgdnet()</a></code>,
<code><a href='sgdnet-package.html'>sgdnet-package()</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Gaussian regression with sparse features with ridge penalty</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>sgdnet</span>(<span class='no'>abalone</span>$<span class='no'>x</span>, <span class='no'>abalone</span>$<span class='no'>y</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0</span>)

<span class='co'># Binomial logistic regression with elastic net penalty, no intercept</span>
<span class='no'>binom_fit</span> <span class='kw'>&lt;-</span> <span class='fu'>sgdnet</span>(<span class='no'>heart</span>$<span class='no'>x</span>,
                    <span class='no'>heart</span>$<span class='no'>y</span>,
                    <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"binomial"</span>,
                    <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
                    <span class='kw'>intercept</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='co'># Multinomial logistic regression with lasso</span>
<span class='no'>multinom_fit</span> <span class='kw'>&lt;-</span> <span class='fu'>sgdnet</span>(<span class='no'>wine</span>$<span class='no'>x</span>, <span class='no'>wine</span>$<span class='no'>y</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"multinomial"</span>)

<span class='co'># Multivariate gaussian regression</span>
<span class='no'>mgaussian_fit</span> <span class='kw'>&lt;-</span> <span class='fu'>sgdnet</span>(<span class='no'>student</span>$<span class='no'>x</span>, <span class='no'>student</span>$<span class='no'>y</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='st'>"mgaussian"</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#model-families">Model families</a></li>

      <li><a href="#regularization-path">Regularization Path</a></li>

      <li><a href="#relationship-with-glmnet">Relationship with glmnet</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Johan Larsson, Toby Dylan Hocking, Michael Weylandt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

