# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Rescale weights and intercept before returning these to user
#'
#' Currently no processing, and therefore no rescaling, is done
#' when the intercept is fit. If x is sparse.
#'
#' @param weights weights
#' @param intercept intercept
#' @param x_center the offset (mean) used to possibly have centered x
#' @param x_scale the scaling that was applied to x
#' @param y_center the offset (mean) that y was offset with
#' @param n_features the number of features
#' @param fit_intercept whether to fit the intercept
#' @param is_sparse whether the features are sparse
#'
#' @return `weights` and `intercept` are rescaled.
NULL

#' Adapative transposing of feature matrix
#'
#' For sparse matrices, armadillo does not (yet?) have a inplace
#' transpose method, so we overload for sparse and dense matrices,
#' transposing inplace when x is dense.
#'
#' @param x a sparse or dense matrix
#'
#' @return x transposed.
#'
#' @keywords internal
#' @noRd
NULL

#' Setup sgdnet Model Options
#'
#' Collect parameters from `control` and setup storage for coefficients,
#' intercepts, gradients, and more so that we can iterate along the
#' regularization path using warm starts for successive iterations.
#'
#' @param x features
#' @param y response
#' @param is_sparse whether x is sparse or not
#' @param control a list of control parameters
#'
#' @return See [SgdnetCpp].
#' @noRd
#' @keywords internal
NULL

#' Fit a Model with sgdnet
#'
#' This main use of this function is calling the templated SetupSgdnet()
#' so that the dense and sparse implementations are compiled and
#' called appropriately. The control parameters in `control` are just
#' passed along.
#'
#' @param x_in feature matrix
#' @param y response matrix
#' @param control a list of control parameters
#'
#' @return A list of
#'   * ao: the intercept,
#'   * beta: the weights,
#'   * losses: the loss at each outer iteration per fit,
#'   * npasses: the number of effective passes (epochs) accumulated over,
#'     all lambda values, and
#'   * return_codes: the convergence result. 0 mean that the algorithm
#'     converged, 1 means that `max_iter` was reached before the algorithm
#'     converged.
#'
#' @keywords internal
SgdnetCpp <- function(x_in, y, control) {
    .Call(`_sgdnet_SgdnetCpp`, x_in, y, control)
}

